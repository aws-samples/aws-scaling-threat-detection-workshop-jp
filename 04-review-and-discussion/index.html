



<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="このワークショップは、AWS セキュリティサービスを理解し、そのサービスを使用して貴社環境の脅威を識別および修復する方法を学習する手助けとなるように設計されています。Amazon GuardDuty、Amazon Macie、Amazon Inspector、AWS Security Hub などのサービスを使用します。これらのサービスを使用して、攻撃中および攻撃後の脅威を調査し、通知と修復パイプラインを設定し、追加的な保護策を講じて、貴社環境のセキュリティを改善する方法を学習します。">
      
      
        <link rel="canonical" href="https://scaling-threat-detection.awssecworkshops.jp/04-review-and-discussion/">
      
      
        <meta name="author" content="aws-security-workshops@amazon.com">
      
      
        <meta name="lang:clipboard.copy" content="クリップボードへコピー">
      
        <meta name="lang:clipboard.copied" content="コピーしました">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="何も見つかりませんでした">
      
        <meta name="lang:search.result.one" content="1件見つかりました">
      
        <meta name="lang:search.result.other" content="#件見つかりました">
      
        <meta name="lang:search.tokenizer" content="[\s\-　、。，．]+">
      
      <link rel="shortcut icon" href="../assets/images/aws-favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title># モジュール 4: レビューとディスカッション - AWS 環境における脅威検知と対応</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/custom.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#4" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <!--
  Copyright (c) 2016-2018 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->
<header class="md-header" data-md-component="header">

    <!-- Top-level navigation -->
    <nav class="md-header-nav md-grid">
      <div class="md-flex">
  
        <!-- Link to home -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://aws.amazon.com/"
              title="Amazon Web Services"
              class="md-header-nav__button md-logo">
            
              <img src="../assets/images/aws_smile_logo.png" width="40" height="24" />
            
          </a>
        </div>
  
        <!-- Button to toggle drawer -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button"
              for="__drawer"></label>
        </div>
  
        <!-- Header title -->
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title"
              data-md-component="title">
            
              
                <span class="md-header-nav__topic">
                  AWS 環境における脅威検知と対応
                </span>
                <span class="md-header-nav__topic">
                  # モジュール 4: レビューとディスカッション
                </span>
              
            
          </div>
        </div>
        
        
        <!-- Button to open search dialogue -->
        <!--
        <div class="md-flex__cell md-flex__cell--shrink">
          
            
              <label class="md-icon md-icon--search md-header-nav__button"
                  for="__search"></label>
  
              
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            検索キーワードを入力してください
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
            
          
        </div>

         -->
         
         <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-flex__ellipsis md-header-nav__lang">
                <div>
                    <button onclick="window.location.href = 'https://awssecworkshops.jp/';" class="md-lang-dropbtn fa fa-home"></button>
                </div>
            </div>
        </div>
  
        <!-- Repository containing source -->
        
          <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-header-nav__source">
              


  

<a href="https://github.com/aws-samples/aws-scaling-threat-detection-workshop-jp/" title="リポジトリへ" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/aws-scaling-threat-detection-workshop-jp
  </div>
</a>
            </div>
          </div>
        
      </div>
    </nav>
  </header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="概要" class="md-tabs__link md-tabs__link--active">
        概要
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!--
  Copyright (c) 2016-2019 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Main navigation -->
<nav class="md-nav md-nav--primary" data-md-level="0">

  <!-- Site title -->
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://scaling-threat-detection.awssecworkshops.jp/"
        title="AWS 環境における脅威検知と対応" class="md-nav__button md-logo">
      
        <img src="../assets/images/aws_smile_logo.png" width="48" height="48" />
      
    </a>
    環境における脅威検知と対応
  </label>

  <!-- Repository containing source -->
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/aws-samples/aws-scaling-threat-detection-workshop-jp/" title="リポジトリへ" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/aws-scaling-threat-detection-workshop-jp
  </div>
</a>
    </div>
  

  <!-- Render item list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="概要" class="md-nav__link">
      概要
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../01-environment-setup/" title="モジュール 1: 環境構築と設定" class="md-nav__link">
      モジュール 1: 環境構築と設定
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../02-attack-simulation/" title="モジュール 2: 攻撃シミュレーション" class="md-nav__link">
      モジュール 2: 攻撃シミュレーション
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../03-detection-and-remediation/" title="モジュール 3: 検知、調査、および対応" class="md-nav__link">
      モジュール 3: 検知、調査、および対応
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        # モジュール 4: レビューとディスカッション
      </label>
    
    <a href="./" title="# モジュール 4: レビューとディスカッション" class="md-nav__link md-nav__link--active">
      # モジュール 4: レビューとディスカッション
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目次</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="アーキテクチャの概要" class="md-nav__link">
    アーキテクチャの概要
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="何が起こっていたのか" class="md-nav__link">
    何が起こっていたのか
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="クリーンアップ" class="md-nav__link">
    クリーンアップ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="完了です!" class="md-nav__link">
    完了です!
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contribute/" title="コントリビュートのガイドライン" class="md-nav__link">
      コントリビュートのガイドライン
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目次</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="アーキテクチャの概要" class="md-nav__link">
    アーキテクチャの概要
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="何が起こっていたのか" class="md-nav__link">
    何が起こっていたのか
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="クリーンアップ" class="md-nav__link">
    クリーンアップ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="完了です!" class="md-nav__link">
    完了です!
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aws-samples/aws-scaling-threat-detection-workshop-jp/edit/master/docs/04-review-and-discussion.md" title="編集" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="4">モジュール 4: レビューとディスカッション</h1>
<p>最後のモジュールでは、ワークショップについて簡単に説明します（また、何が起こったのかを正確に議論します）。また、いくつかの質問に答え、ワークショップ環境をクリーンアップする方法も説明します (AWS アカウントが今後請求されないようにします)。</p>
<p><strong>アジェンダ</strong></p>
<ol>
<li>レビューとディスカッション – 10 分</li>
<li>質問 – 10 分</li>
<li>クリーンアップ – 5 分</li>
</ol>
<h2 id="_1">アーキテクチャの概要</h2>
<p>ワークショップ全体の設定の図: 
<img alt="Part 1 Diagram" src="../images/04-diagram-module4.png" /></p>
<h2 id="_2">何が起こっていたのか</h2>
<p>ワークショップの<strong>モジュール 1</strong> で、GuardDuty、Macie および簡単な通知と修復パイプラインを含むインフラストラクチャの初期設定をしました。一部の手順では手動の設定が必要でしたが、いくつかの構成要素を設定する CloudFormation テンプレートも実行しました。<strong>モジュール 2</strong> では、2 つ目の CloudFormation テンプレートを使って攻撃をシミュレートしました。2 つの EC2 インスタンスが作成し、1 つのインスタンス (<strong>Malicious Host</strong>) には EIP がアタッチされており、GuardDuty カスタム脅威リストに追加されています。<strong>Malicious Host</strong> は他のインスタンスと同じ VPC に存在しますが、シナリオの都合上 (さらに、侵入テストリクエストを送信しなくてもすむように)、インターネット上にあるかのように動作し、攻撃用のコンピュータを役割をしてしました。もう 1 つのインスタンス (<strong>Compromised Instance</strong>) はウェブサーバーであり、<strong>Malicious Host</strong> によって乗っ取られました。<strong>モジュール 3</strong> では、攻撃を調査し、破損を修復し、将来の攻撃に備えていくつかの自動修復を設定しました。   </p>
<p><strong>攻撃時に何が起きたか</strong></p>
<ol>
<li>
<p>モジュール 2 の CloudFormation テンプレートによって 2 つのインスタンスが作成されました。それらのインスタンスは同じ VPC 内の別のサブネットにあります。<strong>Malicious Host</strong> は攻撃者を表し、インターネットに存在するものとしています。<strong>Malicious Host</strong> の Elastic IP は、GuardDuty のカスタム脅威リストにあります。もう 1 つのインスタンスは <strong>Compromised Instance</strong> という名前で、AWS にリフトアンドシフトされたウェブサーバーを表しています。</p>
</li>
<li>
<p>会社のポリシーでは、SSHは鍵ベースの認証だけを有効にする必要がありましたが、ある時点で SSH のパスワード認証が <strong>Compromised Instance</strong> で有効になりました。 </p>
<div class="admonition info">
<p class="admonition-title">この誤った設定は、GuardDuty の検出結果からトリガーされた Inspector スキャンによって特定されます。</p>
</div>
</li>
<li>
<p><strong>Malicious Host</strong> が、<strong>Compromised Instance</strong> に対してブルートフォース SSH パスワード攻撃を実行しました。ブルートフォース攻撃は成功するように設計されています。</p>
<div class="admonition info">
<p class="admonition-title"><strong>GuardDuty の検出結果</strong>: UnauthorizedAccess:EC2/SSHBruteForce</p>
</div>
</li>
<li>
<p>SSH ブルートフォース攻撃が成功し、攻撃者が <strong>Compromised Instance</strong> にログインできました。</p>
<div class="admonition info">
<p class="admonition-title">ログインの成功は CloudWatch ログ (/threat-detection-wksp/var/log/secure) によって確認できます。</p>
</div>
</li>
<li>
<p>モジュール 2 の CloudFormation テンプレートによって作成された EC2 インスタンスは、<strong>データ</strong>バケットのデフォルトの暗号化が無効にしました。さらに CloudFormation テンプレートによって<strong>データ</strong>バケットが外部公開されました。これは、モジュール 3 の調査の Macie の部分によって使用されます。攻撃者がバケットを公開し、バケットのデフォルトの暗号化設定を解除したようです。</p>
<div class="admonition info">
<p class="admonition-title">Macie アラート: S3 バケット IAM ポリシーはグローバル読み取り権限を付与します。</p>
</div>
</li>
<li>
<p>Compromised Instance には、Malicious Host を継続的に ping する cron ジョブがあり、カスタム脅威リストに基づいて GuardDuty 検出結果を生成します。</p>
<div class="admonition info">
<p class="admonition-title"><strong>GuardDuty の検出結果</strong>: UnauthorizedAccess:EC2/MaliciousIPCaller.Custom</p>
</div>
</li>
<li>
<p>API 関連の検出結果を生成した API 呼び出しは、<strong>Malicious Host</strong> からのものです。この呼び出しでは、<strong>Malicious Host</strong> で実行されている EC2 の IAM ロールからの一時認証情報が使用されています。<strong>Malicious Host</strong> にアタッチされた EIP がカスタム脅威リストにあるため、GuardDuty の検出結果が生成されます。  </p>
<div class="admonition info">
<p class="admonition-title"><strong>GuardDuty の検出結果</strong>: Recon:IAMUser/MaliciousIPCaller.Custom</p>
</div>
<div class="admonition info">
<p class="admonition-title"><strong>GuardDuty の検出結果</strong>: UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom</p>
</div>
</li>
<li>
<p>GuardDuty の検出結果によっていくつかの CloudWatch イベントルールが呼び出され、これらのルールによって様々なサービスがトリガーされます。</p>
<ol>
<li><strong>CloudWatch イベントルール</strong>: 一般的な GuardDuty 検出結果によって、SNS によるメールの送信がトリガーされる CloudWatch イベントルールが呼び出されます。</li>
<li><strong>CloudWatch イベントルール</strong>: 一般的な Macie アラートによって、SNS によるメールの送信がトリガーされる CloudWatch イベントルールが呼び出されます。</li>
<li><strong>CloudWatch イベントルール</strong>: SSH ブルートフォース攻撃の検出結果によって、NACL を介して攻撃者の IP アドレスをブロックする Lambda 関数、および EC2 インスタンスで Inspector スキャンを実行する Lambda 関数をトリガーする CloudWatch イベントルールが呼び出されます。</li>
<li><strong>CloudWatch イベントルール</strong>: Unauthorized Access Custom MaliciousIP の検出結果によって、NACL を介して攻撃者の IP アドレスをブロックする Lambda 関数をトリガーする CloudWatch イベントルールが呼び出されます。</li>
</ol>
</li>
</ol>
<h2 id="_3">クリーンアップ</h2>
<p>アカウントへの請求を防ぐために、作成したインフラストラクチャをクリーンアップすることをお勧めします。ワークショップついてもう少し調べるためにそのままにしておく場合は、終了時に忘れずにクリーンアップしてください。AWS アカウントで作成したものを実行中のまま忘れてしまうと、料金が発生します。  </p>
<div class="admonition info">
<p class="admonition-title">一部のリソースは CloudFormation スタックを削除する前に手動で削除する必要があるため、以下のステップを順番通りに実行してください。</p>
</div>
<ol>
<li>
<p>ワークショップ用に作成された Inspector オブジェクトを削除します。</p>
<ul>
<li><a href="https://us-west-2.console.aws.amazon.com/inspector" target="_blank">Amazon Inspector</a> コンソールに移動します。</li>
<li>左のナビゲーションペインの <strong>Assessment targets (評価ターゲット)</strong> をクリックします。</li>
<li><strong>threat-detection-wksp</strong> で開始するものをすべて削除します。</li>
</ul>
</li>
<li>
<p>侵害された EC2 インスタンスの IAM ロールおよび Inspector の サービスリンクドロールを削除します (このロールをまだ作成していなかった場合)。</p>
<ul>
<li><a href="https://console.aws.amazon.com/iam/" target="_blank">AWS IAM</a> コンソールに移動します。</li>
<li><strong>Roles (ロール)</strong> をクリックします。</li>
<li><strong>threat-detection-wksp-compromised-ec2</strong> という名前のロールを探します。</li>
<li>このロールの横にあるチェックボックスをクリックし、<strong>Delete(削除)</strong> をクリックします。</li>
<li><strong>AWSServiceRoleForAmazonInspector</strong> という名前のロールに対して、このステップを繰り返します。</li>
</ul>
</li>
<li>
<p>モジュール 1 の CloudFormation テンプレートによって作成された 3 つの S3 バケット (<strong>threat-detection-wksp</strong> で開始し、<strong>-data</strong>、<strong>-threatlist</strong>、および <strong>-logs</strong> で終了するバケット) をすべて削除します。</p>
<ul>
<li><a href="https://s3.console.aws.amazon.com/s3/home?region=us-west-2" target="_blank">Amazon S3</a> コンソールに移動します。</li>
<li>適切なバケットをクリックします。</li>
<li><strong>Delete Bucket (バケットの削除)</strong> をクリックします。</li>
<li>バケットの名前をコピーアンドペーストします (これは、そのバケットを本当に削除してよいかどうかの追加の確認です)。</li>
<li>3 つのバケットすべてに対して前述のステップを繰り返します。</li>
</ul>
</li>
<li>
<ol>
<li>モジュール 1 および 2 の CloudFormation スタック (<strong>ThreatDetectionWksp-Env-Setup</strong> および <strong>ThreatDetectionWksp-Attacks</strong>) を削除します。</li>
<li><a href="https://us-west-2.console.aws.amazon.com/cloudformation/home?region=us-west-2#/stacks?filter=active" target="_blank">AWS CloudFormation</a> コンソールに移動します。</li>
<li>適切なスタックを選択します。</li>
<li><strong>Action (アクション)</strong> を選択します。</li>
<li><strong>Delete Stack (スタックの削除)</strong> をクリックします。</li>
<li>それぞれのスタックに対して前述のステップを繰り返します。</li>
</ol>
<div class="admonition info">
<p class="admonition-title">最初のスタックが削除されるのを待たずに 2 番目のスタックを削除できます。</p>
</div>
</li>
<li>
<p>GuardDuty カスタム脅威リストを削除し、GuardDuty を無効にします (ワークショップの前に GuardDuty をまだ有効にしていなかった場合)。</p>
<ul>
<li><a href="https://us-west-2.console.aws.amazon.com/guardduty/" target="_blank">Amazon GuardDuty</a> コンソールに移動します。</li>
<li>左のナビゲーションの <strong>Lists (リスト)</strong> をクリックします。</li>
<li><strong>Custom-Threat-List</strong> で開始する脅威リストの横にある <strong>X</strong> をクリックします。</li>
<li>左のナビゲーションにあるナビゲーションペインの <strong>Settings (設定)</strong> をクリックします。</li>
<li><strong>Disable (無効化)</strong> の横にあるチェックボックスをクリックします。</li>
<li><strong>Save settings (設定の保存)</strong> をクリックしてから、ポップアップボックスの <strong>Disable (無効化)</strong> をクリックします。</li>
</ul>
</li>
<li>
<p>AWS Security Hub を無効にします。</p>
<ul>
<li><a href="https://us-west-2.console.aws.amazon.com/securityhub/home?region=us-west-2#/findings" target="_blank">AWS Security Hub</a> コンソールに移動します。</li>
<li>左のナビゲーションの <strong>Settings (設定)</strong> をクリックします。</li>
<li>上のナビゲーションの <strong>General (一般)</strong> をクリックします。</li>
<li><strong>Disable AWS Security Hub (AWS Security Hub の無効化)</strong> をクリックします。</li>
</ul>
</li>
<li>
<p>作成した手動の CloudWatch イベントルールと、生成された CloudWatch ログを削除します。</p>
<ul>
<li><a href="https://us-west-2.console.aws.amazon.com/cloudwatch" target="_blank">AWS CloudWatch</a> コンソールに移動します。</li>
<li>左のナビゲーションペインの <strong>Rules (ルール)</strong> をクリックします。</li>
<li><strong>threat-detection-wksp-guardduty-finding-maliciousip</strong> の横にあるラジオボタンをクリックします。</li>
<li><strong>Action (アクション)</strong> を選択し、<strong>Delete (削除)</strong> をクリックします。</li>
<li>左のナビゲーションペインの <strong>Logs (ログ)</strong> をクリックします。</li>
<li><strong>/aws/lambda/threat-detection-wksp-inspector-role-creation</strong> の横にあるラジオボタンをクリックします。</li>
<li><strong>Action (アクション)</strong> を選択し、<strong>Delete log group (ロググループの削除)</strong> をクリックしてから、ポップアップボックスの <strong>Yes, Delete (はい、削除します)</strong> をクリックします。</li>
<li>以下に対して繰り返します。 <ul>
<li><strong>/aws/lambda/threat-detection-wksp-remediation-inspector</strong></li>
<li><strong>/aws/lambda/threat-detection-wksp-remediation-nacl</strong></li>
<li><strong>/threat-detection-wksp/var/log/secure</strong> </li>
</ul>
</li>
</ul>
</li>
<li>
<p>SNS トピックに登録したときに作成された SNS サブスクリプションを削除します。</p>
<ul>
<li><a href="https://us-west-2.console.aws.amazon.com/sns" target="_blank">AWS SNS</a> コンソールに移動します。</li>
<li>左のナビゲーションの <strong>Subscriptions (サブスクリプション)</strong> をクリックします。</li>
<li>自分のメールアドレスがエンドポイントとして表示されているサブスクリプションで、<strong>Subscription ARN (サブスクリプション ARN)</strong> に <strong>threat-detection-wksp</strong> が含まれているサブスクリプションについて、その横にあるチェックボックスを選択します。</li>
<li><strong>Action (アクション)</strong> を選択し、<strong>Delete subscriptions (サブスクリプションの削除)</strong> をクリックします。</li>
</ul>
</li>
<li>
<p>Macie を無効にします (ワークショップの前に Macie を有効にしていなかった場合)。</p>
<ul>
<li><a href="https://mt.us-west-2.macie.aws.amazon.com/" target="_blank">Amazon Macie</a> コンソールに移動します。</li>
<li>右上の角で、<strong>Region (リージョン)</strong> の左にある下向き矢印を選択し、<strong>Macie General Settings (Macie 一般設定)</strong> を選択します。</li>
<li>2 つのボックスを選択し、<strong>Disable Amazon Macie (Amazon Macie の無効化)</strong> をクリックします。</li>
</ul>
</li>
</ol>
<h2 id="_4">完了です!</h2>
<p>このワークショップを完了しました。おめでとうございます! ここはワークショップの永続的なサイトですので、好きなときにいつでも再度アクセスしてください。</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../03-detection-and-remediation/" title="モジュール 3: 検知、調査、および対応" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前
                </span>
                モジュール 3: 検知、調査、および対応
              </span>
            </div>
          </a>
        
        
          <a href="../contribute/" title="コントリビュートのガイドライン" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  次
                </span>
                コントリビュートのガイドライン
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://awssecworkshops.jp" class="md-footer-social__link fa fa-home"></a>
    
      <a href="https://aws.amazon.com/security/" class="md-footer-social__link fa fa-shield"></a>
    
      <a href="https://twitter.com/awssecurityinfo?lang=en" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://aws.amazon.com/blogs/security/" class="md-footer-social__link fa fa-rss"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.d9aa80ab.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>