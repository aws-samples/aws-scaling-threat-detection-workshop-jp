



<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="このワークショップは、AWS セキュリティサービスを理解し、そのサービスを使用して貴社環境の脅威を識別および修復する方法を学習する手助けとなるように設計されています。Amazon GuardDuty、Amazon Macie、Amazon Inspector、AWS Security Hub などのサービスを使用します。これらのサービスを使用して、攻撃中および攻撃後の脅威を調査し、通知と修復パイプラインを設定し、追加的な保護策を講じて、貴社環境のセキュリティを改善する方法を学習します。">
      
      
        <link rel="canonical" href="https://scaling-threat-detection.awssecworkshops.jp/01-environment-setup/">
      
      
        <meta name="author" content="aws-security-workshops@amazon.com">
      
      
        <meta name="lang:clipboard.copy" content="クリップボードへコピー">
      
        <meta name="lang:clipboard.copied" content="コピーしました">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="何も見つかりませんでした">
      
        <meta name="lang:search.result.one" content="1件見つかりました">
      
        <meta name="lang:search.result.other" content="#件見つかりました">
      
        <meta name="lang:search.tokenizer" content="[\s\-　、。，．]+">
      
      <link rel="shortcut icon" href="../assets/images/aws-favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>モジュール 1: 環境構築と設定 - AWS 環境における脅威検知と対応</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/custom.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#1" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <!--
  Copyright (c) 2016-2018 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->
<header class="md-header" data-md-component="header">

    <!-- Top-level navigation -->
    <nav class="md-header-nav md-grid">
      <div class="md-flex">
  
        <!-- Link to home -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://aws.amazon.com/"
              title="Amazon Web Services"
              class="md-header-nav__button md-logo">
            
              <img src="../assets/images/aws_smile_logo.png" width="40" height="24" />
            
          </a>
        </div>
  
        <!-- Button to toggle drawer -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button"
              for="__drawer"></label>
        </div>
  
        <!-- Header title -->
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title"
              data-md-component="title">
            
              
                <span class="md-header-nav__topic">
                  AWS 環境における脅威検知と対応
                </span>
                <span class="md-header-nav__topic">
                  モジュール 1: 環境構築と設定
                </span>
              
            
          </div>
        </div>
        
        
        <!-- Button to open search dialogue -->
        <!--
        <div class="md-flex__cell md-flex__cell--shrink">
          
            
              <label class="md-icon md-icon--search md-header-nav__button"
                  for="__search"></label>
  
              
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            検索キーワードを入力してください
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
            
          
        </div>

         -->
         
         <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-flex__ellipsis md-header-nav__lang">
                <div>
                    <button onclick="window.location.href = 'https://awssecworkshops.jp/';" class="md-lang-dropbtn fa fa-home"></button>
                </div>
            </div>
        </div>
  
        <!-- Repository containing source -->
        
          <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-header-nav__source">
              


  

<a href="https://github.com/aws-samples/aws-scaling-threat-detection-workshop-jp/" title="リポジトリへ" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/aws-scaling-threat-detection-workshop-jp
  </div>
</a>
            </div>
          </div>
        
      </div>
    </nav>
  </header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="概要" class="md-tabs__link md-tabs__link--active">
        概要
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!--
  Copyright (c) 2016-2019 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Main navigation -->
<nav class="md-nav md-nav--primary" data-md-level="0">

  <!-- Site title -->
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://scaling-threat-detection.awssecworkshops.jp/"
        title="AWS 環境における脅威検知と対応" class="md-nav__button md-logo">
      
        <img src="../assets/images/aws_smile_logo.png" width="48" height="48" />
      
    </a>
    環境における脅威検知と対応
  </label>

  <!-- Repository containing source -->
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/aws-samples/aws-scaling-threat-detection-workshop-jp/" title="リポジトリへ" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/aws-scaling-threat-detection-workshop-jp
  </div>
</a>
    </div>
  

  <!-- Render item list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="概要" class="md-nav__link">
      概要
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        モジュール 1: 環境構築と設定
      </label>
    
    <a href="./" title="モジュール 1: 環境構築と設定" class="md-nav__link md-nav__link--active">
      モジュール 1: 環境構築と設定
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目次</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#aws-cloudformation" title="AWS CloudFormation テンプレートのデプロイ" class="md-nav__link">
    AWS CloudFormation テンプレートのデプロイ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-cloudwatch" title="Amazon CloudWatch イベントルールおよび自動応答の設定" class="md-nav__link">
    Amazon CloudWatch イベントルールおよび自動応答の設定
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-guardduty" title="Amazon GuardDuty の有効化" class="md-nav__link">
    Amazon GuardDuty の有効化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-macie" title="Amazon Macie の有効化" class="md-nav__link">
    Amazon Macie の有効化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-macie_1" title="データの検出と分類のための Amazon Macie の設定" class="md-nav__link">
    データの検出と分類のための Amazon Macie の設定
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aws-security-hub" title="AWS Security Hub の有効化" class="md-nav__link">
    AWS Security Hub の有効化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" title="アーキテクチャの概要" class="md-nav__link">
    アーキテクチャの概要
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../02-attack-simulation/" title="モジュール 2: 攻撃シミュレーション" class="md-nav__link">
      モジュール 2: 攻撃シミュレーション
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../03-detection-and-remediation/" title="モジュール 3: 検知、調査、および対応" class="md-nav__link">
      モジュール 3: 検知、調査、および対応
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../04-review-and-discussion/" title="# モジュール 4: レビューとディスカッション" class="md-nav__link">
      # モジュール 4: レビューとディスカッション
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contribute/" title="コントリビュートのガイドライン" class="md-nav__link">
      コントリビュートのガイドライン
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目次</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#aws-cloudformation" title="AWS CloudFormation テンプレートのデプロイ" class="md-nav__link">
    AWS CloudFormation テンプレートのデプロイ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-cloudwatch" title="Amazon CloudWatch イベントルールおよび自動応答の設定" class="md-nav__link">
    Amazon CloudWatch イベントルールおよび自動応答の設定
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-guardduty" title="Amazon GuardDuty の有効化" class="md-nav__link">
    Amazon GuardDuty の有効化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-macie" title="Amazon Macie の有効化" class="md-nav__link">
    Amazon Macie の有効化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-macie_1" title="データの検出と分類のための Amazon Macie の設定" class="md-nav__link">
    データの検出と分類のための Amazon Macie の設定
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aws-security-hub" title="AWS Security Hub の有効化" class="md-nav__link">
    AWS Security Hub の有効化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" title="アーキテクチャの概要" class="md-nav__link">
    アーキテクチャの概要
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aws-samples/aws-scaling-threat-detection-workshop-jp/edit/master/docs/01-environment-setup.md" title="編集" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="1">モジュール 1: 環境構築と設定</h1>
<p>最初のモジュールでは、検知と対応の統制の初期設定をします。2 つの CloudFormation テンプレートのうち、1つ目を実行して、これらの Control のいくつかの作成を自動化し、残りのものを手動で設定します。</p>
<h2 id="aws-cloudformation">AWS CloudFormation テンプレートのデプロイ</h2>
<p>シナリオを開始して環境を設定するには、モジュール 1 の CloudFormation テンプレートを実行する必要があります。</p>
<div class="admonition info">
<p class="admonition-title">CloudFormation Template実行する前に <a href="https://github.com/aws-samples/aws-scaling-threat-detection-workshop/blob/master/templates/01-environment-setup.yml" target="_blank">こちら</a href>.もご確認ください。</p>
</div>
<table>
<thead>
<tr>
<th>リージョン</th>
<th>デプロイ</th>
</tr>
</thead>
<tbody>
<tr>
<td>US West 2 (Oregon)</td>
<td><a href="https://console.aws.amazon.com/cloudformation/home?region=us-west-2#/stacks/new?stackName=ThreatDetectionWksp-Env-Setup&templateURL=https://s3-us-west-2.amazonaws.com/sa-security-specialist-workshops-us-west-2/threat-detect-workshop/staging/01-environment-setup.yml" target="_blank"><img alt="Deploy Module 1 in us-west-2" src="../images/deploy-to-aws.png" /></a></td>
</tr>
</tbody>
</table>
<ol>
<li>
<p>上の <strong>Deploy to AWS (AWS へのデプロイ)</strong> ボタンをクリックします。これにより、テンプレートを実行するコンソールに自動的に移動します。</p>
</li>
<li>
<p><strong>Specify Details (詳細の指定)</strong> セクションで、以下に示す必要なパラメータを入力します。</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Stack name</td>
<td>ThreatDetectionWksp-Env-Setup</td>
</tr>
<tr>
<td>Email Address</td>
<td>A <strong><em>valid</em></strong> email address</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>パラメータを入力したら、<strong>Next (次)</strong> をクリックし、もう一度 <strong>Next (次)</strong> をクリックします (このページの設定はデフォルトのままにします)。</p>
</li>
<li>
<p>最後に、テンプレートによって IAM ロールが作成されることに確認し、<strong>Create (作成)</strong> をクリックします。</p>
</li>
</ol>
<p><img alt="IAM Capabilities" src="../images/iam-capabilities.png" /></p>
<p>これによって CloudFormation コンソールに戻ります。ページを更新して、作成を開始するスタックを確認することができます。次に進む前に、スタックが以下に示すように <strong>CREATE_COMPLETE</strong> ステータスであることを確認します。</p>
<p><img alt="Stack Complete" src="../images/01-stack-complete.png" /></p>
<p>SNS から、サブスクリプションを確認するように依頼するメールが届きます。ワークショップ中に AWS のサービスからメールアラートを受信できるように、<strong>サブスクリプションを確認します</strong>。</p>
<div class="admonition info">
<p class="admonition-title">アラートメールの送信元は <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#45;&#114;&#101;&#112;&#108;&#121;&#64;&#115;&#110;&#115;&#46;&#97;&#109;&#97;&#122;&#111;&#110;&#97;&#119;&#115;&#46;&#99;&#111;&#109;">&#110;&#111;&#45;&#114;&#101;&#112;&#108;&#121;&#64;&#115;&#110;&#115;&#46;&#97;&#109;&#97;&#122;&#111;&#110;&#97;&#119;&#115;&#46;&#99;&#111;&#109;</a> になります。受信できない場合は、ご利用のメール環境でフォルダ振り分けがされていたり、SPAM判定をされていたりしないかご確認ください。</p>
</div>
<h2 id="amazon-cloudwatch">Amazon CloudWatch イベントルールおよび自動応答の設定</h2>
<p>先ほど実行した CloudFormation テンプレートによって、アラートおよび応答のための 3 つの <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/WhatIsCloudWatchEvents.html" target="_blank">CloudWatch イベントルール</a> が作成されました。以下の手順で最終的なルールを作成します。この後、メール通知を受け取り、脅威に対応するために AWS Lambda 関数をトリガーするための必要なすべてのルールが設定されます。</p>
<p>以下は、コンソールを通じてこのルールを作成する手順ですが、<a href="http://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings_cloudwatch.html" target="_blank">Amazon GuardDuty ドキュメント</a>を確認することで、プログラムでルールを実行する方法についても詳しく知ることができます</p>
<ol>
<li><a href="https://us-west-2.console.aws.amazon.com/cloudwatch/home?region=us-west-2" target="_blank">CloudWatch コンソール</a> (us-west-2) を開きます。</li>
<li>
<p>左のナビゲーションペインで、<strong>Events (イベント)</strong> の下の <strong>Rules (ルール)</strong> をクリックします。</p>
<div class="admonition question">
<p class="admonition-title">現在のルールは何を実行するように設定されていますか?</p>
</div>
</li>
<li>
<p><strong>Create Rule (ルールの作成)</strong> をクリックします。</p>
</li>
<li>
<p><strong>Event Pattern (イベントパターン)</strong> の下で、<strong>Build event pattern to match events by service (サービス別のイベントに一致するイベントパターンの構築)</strong> をクリックし、ドロップダウンの <strong>Custom event pattern (カスタムイベントパターン)</strong> を選択します。以下のカスタムイベントパターンを貼り付けます。</p>
</li>
</ol>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;aws.guardduty&quot;</span>
  <span class="p">],</span>
  <span class="nt">&quot;detail&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;UnauthorizedAccess:EC2/MaliciousIPCaller.Custom&quot;</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>ターゲットについては、<strong>Add Target (ターゲットの追加)</strong> をクリックし、<strong>Lambda Function (Lambda 関数)</strong> を選択してから <strong>threat-detection-wksp-remediation-nacl</strong> を選択します。<strong>Configure details (詳細の構成)</strong> をクリックします。</p>
<ol>
<li><strong>Configure rule details (ルールの詳細の構成)</strong> 画面で、<strong>Name (名前)</strong> および <strong>Description (説明)</strong> を入力します (以下を参照)。<ul>
<li>Name (名前): <strong>threat-detection-wksp-guardduty-finding-ec2-maliciousip</strong></li>
<li>Description (説明): <strong>GuardDuty の検出結果: UnauthorizedAccess:EC2/MaliciousIPCaller.Custom</strong></li>
</ul>
</li>
<li><strong>Create rule (ルールの作成)</strong> をクリックします。</li>
<li>
<p><strong>オプション:</strong> Lambda関数が何をしているのかを見てみましょう。Open the <a href="https://us-west-2.console.aws.amazon.com/lambda/home?region=us-west-2" target="_blank">Lambda コンソール</a>を開きます. <strong>threat-detection-wksp-remediation-nacl</strong> という名前の関数をクリックします。</p>
<div class="admonition question">
<p class="admonition-title">この関数は何を行う関数ですか?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Threat-detection-wksp-remediation-inspector 関数は何を行いますか?</p>
</div>
</li>
</ol>
<h2 id="amazon-guardduty">Amazon GuardDuty の有効化</h2>
<p>次のステップは、Amazon GuardDuty の有効化です。Amazon GuardDuty は、悪意のある行動や不正な行動がないか、環境を継続的に監視します。</p>
<ol>
<li>
<p><a href="https://us-west-2.console.aws.amazon.com/guardduty/home?region=us-west-2" target="_blank">Amazon GuardDuty</a> コンソール (us-west-2) に移動します。</p>
</li>
<li>
<p><strong>Get Started (開始)</strong> ボタンをクリックします。</p>
</li>
<li>
<p>次の画面で、<strong>Enable GuardDuty (GuardDuty の有効化)</strong> ボタンをクリックします。</p>
</li>
</ol>
<p>GuardDuty が有効になります。CloudTrail ログ、VPC フローログ、および DNS クエリログが継続的に監視され、環境に脅威がないかチェックされます</p>
<h2 id="amazon-macie">Amazon Macie の有効化</h2>
<p>あなたは機密データを S3 に保管するつもりです。Amazon Macie をすぐに有効にしましょう。Macie は、データアクセスアクティビティを継続的に監視して異常がないかをチェックするセキュリティサービスです。不正アクセスや不注意によるデータ漏洩のリスクを検出するとアラートを生成します。</p>
<ol>
<li>
<p><a href="https://us-west-2.redirection.macie.aws.amazon.com/" target="_blank">Amazon Macie</a> コンソール (us-west-2) に移動します。</p>
</li>
<li>
<p><strong>Get Started (開始)</strong> をクリックします。</p>
</li>
<li>
<p>Macie を有効にすると、サービスにリンクされたロールが作成されます。ロールの権限を確認する場合、<strong>View service role permissions (サービスロールのアクセス許可の表示)</strong> をクリックします。</p>
</li>
<li>
<p><strong>Enable Macie (Macie の有効化)</strong> をクリックします。</p>
</li>
</ol>
<h2 id="amazon-macie_1">データの検出と分類のための Amazon Macie の設定</h2>
<p>Macie は、機密データを自動で検出および分類するためにも使用されます。Macie が有効になったので、S3 バケットのデータを分類するための統合を設定します。</p>
<ol>
<li>
<p>Amazon Macie コンソールで、左のナビゲーションの <strong>Integrations (統合)</strong> をクリックします。</p>
</li>
<li>
<p>AWS アカウント ID (1 つだけあります) を探して <strong>Select (選択)</strong> をクリックします。</p>
</li>
<li>
<p><strong>Add (追加)</strong> をクリックし、次の画面で“-data”で終了する S3 バケットの横にあるチェックボックスをクリックします。<strong>Add (追加)</strong> をクリックします。</p>
</li>
<li>
<p>ここのオプションはデフォルトのままにして <strong>Review (レビュー)</strong> をクリックします。</p>
</li>
<li>
<p>次の画面で <strong>Start Classification (分類の開始)</strong> をクリックします。</p>
</li>
<li>
<p>最後に <strong>Done (終了)</strong> をクリックします。Macie が有効になり、データの検出、分類、および保護を開始しました。</p>
</li>
</ol>
<h2 id="aws-security-hub">AWS Security Hub の有効化</h2>
<p>ここまでで Detective Control の設定が完了したので、<a href="https://aws.amazon.com/security-hub/" target="_blank">AWS Security Hub</a> を有効にする必要があります。これにより、AWS 環境のセキュリティおよびコンプライアンスを包括的に確認できます。</p>
<ol>
<li>
<p><a href="https://us-west-2.console.aws.amazon.com/securityhub/home?region=us-west-2#" target="_blank">AWS Security Hub</a> コンソールに移動します.</p>
</li>
<li>
<p><strong>Enable Security Hub (Security Hub の有効化)</strong> ボタンをクリックします。</p>
</li>
<li>
<p>次の画面で、<strong>Enable AWS Security Hub (AWS Security Hub の有効化)</strong> ボタンをクリックします。</p>
</li>
</ol>
<p>AWS Security Hub が有効になりました。これまで有効化したセキュリティサービスからの検出結果の収集および集約が開始されます。</p>
<h2 id="_1">アーキテクチャの概要</h2>
<p>環境が構成され、操作の準備ができました。Detective Control の構成は以下のようになっています。</p>
<p><img alt="Detective Controls" src="../images/01-diagram-module-1.png" /></p>
<p>環境を適切に設定したら、次のモジュールに進んでください。</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="概要" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前
                </span>
                概要
              </span>
            </div>
          </a>
        
        
          <a href="../02-attack-simulation/" title="モジュール 2: 攻撃シミュレーション" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  次
                </span>
                モジュール 2: 攻撃シミュレーション
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://awssecworkshops.jp" class="md-footer-social__link fa fa-home"></a>
    
      <a href="https://aws.amazon.com/security/" class="md-footer-social__link fa fa-shield"></a>
    
      <a href="https://twitter.com/awssecurityinfo?lang=en" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://aws.amazon.com/blogs/security/" class="md-footer-social__link fa fa-rss"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.d9aa80ab.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>